# MPU6050 Web 3D è¦–è¦ºåŒ–éƒ¨ç½²èªªæ˜

## ğŸ¯ ç³»çµ±æ¶æ§‹

```
æ¨¹è“æ´¾ (Flask Server + MPU6050)
    â†“ WebSocket (å³æ™‚æ•¸æ“š)
é›»è…¦ç€è¦½å™¨ (Three.js 3D è¦–è¦ºåŒ–)
```

## ğŸ“¦ åœ¨æ¨¹è“æ´¾ä¸Šå®‰è£

### 1. å…‹éš†æˆ–æ‹‰å–å°ˆæ¡ˆ

```bash
cd ~
git clone https://github.com/eleanor128/IOT-Drum-Stick.git
cd IOT-Drum-Stick

# æˆ–å¦‚æœå·²ç¶“å­˜åœ¨
cd ~/IOT-Drum-Stick
git pull
```

### 2. å®‰è£ Python å¥—ä»¶

```bash
pip3 install flask flask-socketio python-socketio eventlet mpu6050-raspberrypi smbus2
```

### 3. ç¢ºèª I2C è¨­å®š

```bash
# å•Ÿç”¨ I2C
sudo raspi-config
# â†’ Interface Options â†’ I2C â†’ Enable

# å®‰è£ I2C å·¥å…·
sudo apt-get update
sudo apt-get install -y i2c-tools python3-smbus

# æª¢æ¸¬ MPU6050 (æ‡‰è©²çœ‹åˆ° 0x68)
i2cdetect -y 1
```

## ğŸš€ å•Ÿå‹•ä¼ºæœå™¨

```bash
cd ~/IOT-Drum-Stick
python3 mpu6050_web_visual.py
```

ä½ æ‡‰è©²æœƒçœ‹åˆ°ï¼š

```
MPU6050 Web-based 3D Visualization Server
============================================================
âœ“ MPU6050 æ„Ÿæ¸¬å™¨åˆå§‹åŒ–æˆåŠŸ
å•Ÿå‹•æ„Ÿæ¸¬å™¨è®€å–è¿´åœˆ...

ä¼ºæœå™¨å•Ÿå‹•ä¸­...
è«‹åœ¨ç€è¦½å™¨é–‹å•Ÿ: http://<æ¨¹è“æ´¾IP>:5000
æŒ‰ Ctrl+C åœæ­¢
```

## ğŸ’» åœ¨é›»è…¦ç€è¦½å™¨è§€çœ‹

### 1. æŸ¥è©¢æ¨¹è“æ´¾ IP

åœ¨æ¨¹è“æ´¾ä¸ŠåŸ·è¡Œï¼š

```bash
hostname -I
```

ä¾‹å¦‚: `192.168.1.100`

### 2. é–‹å•Ÿç€è¦½å™¨

åœ¨ä½ çš„é›»è…¦ç€è¦½å™¨è¼¸å…¥ï¼š

```
http://192.168.1.100:5000
```

ä½ æœƒçœ‹åˆ°ï¼š
- **å·¦å´**: å³æ™‚ 3D ç«‹æ–¹é«”ï¼Œéš¨è‘—æ„Ÿæ¸¬å™¨ç§»å‹•
- **å³å´**: æ•¸æ“šé¢æ¿ï¼Œé¡¯ç¤º Roll/Pitch/Yaw å’ŒåŠ é€Ÿåº¦/é™€èºå„€æ•¸å€¼

## ğŸ® æ“ä½œèªªæ˜

- **æ»‘é¼ æ‹–æ›³**: æ—‹è½‰ 3D è¦–è§’
- **æ»¾è¼ª**: ç¸®æ”¾è¦–åœ–
- **é‡ç½®æŒ‰éˆ•**: æ­¸é›¶å§¿æ…‹è§’åº¦
- **å³æ™‚æ›´æ–°**: 100 Hz (æ¯ 10ms æ›´æ–°ä¸€æ¬¡)

## ğŸ§ª æ¸¬è©¦æ„Ÿæ¸¬å™¨

### éœæ­¢æ¸¬è©¦
å°‡æ¨¹è“æ´¾æ”¾åœ¨æ¡Œä¸Šï¼Œè§€å¯Ÿ:
- Roll, Pitch æ‡‰æ¥è¿‘ 0Â°
- Z è»¸åŠ é€Ÿåº¦æ‡‰æ¥è¿‘ 1.0g (é‡åŠ›)

### å‚¾æ–œæ¸¬è©¦
æ…¢æ…¢å‚¾æ–œæ¨¹è“æ´¾:
- Roll/Pitch è§’åº¦æ‡‰è©²è·Ÿè‘—æ”¹è®Š
- 3D ç«‹æ–¹é«”åŒæ­¥æ—‹è½‰

### æ–å‹•æ¸¬è©¦
å¿«é€Ÿæ–å‹• (æ¨¡æ“¬é¼“æ£’æ®å‹•):
- åŠ é€Ÿåº¦å€¼æœƒç¬é–“å¢å¤§
- é™€èºå„€å€¼æœƒå¿«é€Ÿè®ŠåŒ–

## ğŸ”§ æ•…éšœæ’é™¤

### å•é¡Œ 1: ç„¡æ³•é€£æ¥åˆ°ä¼ºæœå™¨

**æª¢æŸ¥:**
```bash
# æ¨¹è“æ´¾é˜²ç«ç‰†
sudo ufw allow 5000

# ç¢ºèªä¼ºæœå™¨é‹è¡Œä¸­
ps aux | grep mpu6050_web_visual
```

### å•é¡Œ 2: æ„Ÿæ¸¬å™¨åˆå§‹åŒ–å¤±æ•—

**æª¢æŸ¥ I2C:**
```bash
# ç¢ºèª I2C å·²å•Ÿç”¨
ls /dev/i2c*  # æ‡‰è©²çœ‹åˆ° /dev/i2c-1

# æƒæè¨­å‚™
i2cdetect -y 1  # æ‡‰è©²åœ¨ 0x68 çœ‹åˆ°è¨­å‚™
```

**æª¢æŸ¥æ¥ç·š:**
- VCC â†’ 3.3V (ä¸è¦ç”¨ 5V!)
- GND â†’ GND
- SDA â†’ GPIO 2 (Pin 3)
- SCL â†’ GPIO 3 (Pin 5)

### å•é¡Œ 3: 3D ç•«é¢ä¸å‹•

**æª¢æŸ¥:**
1. æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…· (F12)
2. æŸ¥çœ‹ Console æ˜¯å¦æœ‰éŒ¯èª¤
3. ç¢ºèª "é€£ç·šç‹€æ…‹" é¡¯ç¤º "å·²é€£æ¥" (ç¶ è‰²)

## ğŸ“Š æ•¸æ“šè§£è®€

### Roll, Pitch, Yaw è§’åº¦
- **Roll (æ©«æ»¾)**: ç¹ X è»¸æ—‹è½‰ (-180Â° ~ 180Â°)
- **Pitch (ä¿¯ä»°)**: ç¹ Y è»¸æ—‹è½‰ (-90Â° ~ 90Â°)
- **Yaw (åèˆª)**: ç¹ Z è»¸æ—‹è½‰ (ç´¯ç©è§’åº¦)

### åŠ é€Ÿåº¦è¨ˆ (g)
- **éœæ­¢æ™‚**: Xâ‰ˆ0, Yâ‰ˆ0, Zâ‰ˆ1.0 (é‡åŠ›)
- **é¼“æ£’æ®å‹•**: ç¬é–“å¯èƒ½è¶…é 2-3g
- **ç”¨é€”**: åµæ¸¬æ‰“æ“Šå‹•ä½œ

### é™€èºå„€ (Â°/s)
- **éœæ­¢æ™‚**: æ¥è¿‘ 0
- **å¿«é€Ÿæ—‹è½‰**: å¯èƒ½é”åˆ°æ•¸ç™¾ Â°/s
- **ç”¨é€”**: è¨ˆç®—è§’åº¦è®ŠåŒ–ç‡

## ğŸ¯ ä¸‹ä¸€æ­¥ï¼šæ‰“æ“Šåµæ¸¬

è§€å¯Ÿæ®å‹•é¼“æ£’æ™‚çš„æ•¸æ“šï¼Œç¢ºå®šé–¾å€¼:

1. **åŠ é€Ÿåº¦é–¾å€¼**: ä¾‹å¦‚ 2.0g (ç•¶ |accel| > 2.0 æ™‚è¦–ç‚ºæ‰“æ“Š)
2. **å†·å»æ™‚é–“**: ä¾‹å¦‚ 100ms (é¿å…é‡è¤‡åµæ¸¬)
3. **å¼·åº¦åˆ†ç´š**:
   - è¼•æ“Š: 2.0g - 3.0g
   - ä¸­æ“Š: 3.0g - 5.0g
   - é‡æ“Š: > 5.0g

æ ¹æ“šé€™äº›æ•¸æ“šï¼Œæ¥ä¸‹ä¾†å¯ä»¥å¯¦ä½œ:
- `mpu6050_drum_detector.py`: æ‰“æ“Šåµæ¸¬æ¨¡çµ„
- èˆ‡ç¯€æ‹åµæ¸¬ (librosa) æ•´åˆ
- å®Œæ•´çš„ç¯€å¥éŠæˆ²ä»‹é¢

## ğŸ“ è‡ªå‹•å•Ÿå‹• (é¸æ“‡æ€§)

å¦‚æœæƒ³è®“æ¨¹è“æ´¾é–‹æ©Ÿè‡ªå‹•å•Ÿå‹•ä¼ºæœå™¨:

```bash
# å»ºç«‹ systemd service
sudo nano /etc/systemd/system/mpu6050-visual.service
```

è²¼ä¸Š:

```ini
[Unit]
Description=MPU6050 Web Visualization
After=network.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/IOT-Drum-Stick
ExecStart=/usr/bin/python3 /home/pi/IOT-Drum-Stick/mpu6050_web_visual.py
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

å•Ÿç”¨:

```bash
sudo systemctl enable mpu6050-visual.service
sudo systemctl start mpu6050-visual.service
sudo systemctl status mpu6050-visual.service
```

## ğŸ¨ é€²éšå®¢è£½åŒ–

### ä¿®æ”¹æ›´æ–°é »ç‡

ç·¨è¼¯ `mpu6050_web_visual.py`:

```python
dt = 0.02  # æ”¹ç‚º 50 Hz (20ms)
```

### ä¿®æ”¹ä¼ºæœå™¨åŸ 

```python
socketio.run(app, host='0.0.0.0', port=8080, debug=False)
```

### èª¿æ•´äº’è£œæ¿¾æ³¢å™¨

```python
alpha = 0.95  # é™ä½é™€èºå„€æ¬Šé‡ï¼Œå¢åŠ åŠ é€Ÿåº¦è¨ˆå½±éŸ¿
```

---

**ğŸ‰ å®Œæˆï¼ç¾åœ¨ä½ æœ‰ä¸€å€‹å®Œæ•´çš„ç¶²é ç‰ˆ 3D æ„Ÿæ¸¬å™¨è¦–è¦ºåŒ–ç³»çµ±ï¼**
